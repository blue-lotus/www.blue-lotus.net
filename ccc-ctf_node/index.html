
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>29c3ctf node writeup - blue-lotus</title>
  <meta name="author" content="blue-lotus">

  
  <meta name="description" content="This a web problem, using node.js as the programming language. It only gives a portal showing a login form. When I started on this problem, there &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.blue-lotus.net//ccc-ctf_node">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="blue-lotus" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="header-inner">
    <span class="first"><a href="/">blue-lotus</a></span>
    <span><a href="/about">about</a></span>
    <span class="last"><a href="/atom.xml" title="subscribe via RSS">rss</a></span>
  </div>
</hgroup>

</header>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">29c3ctf Node Writeup</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-30T00:00:00+08:00" pubdate data-updated="true">Dec 30<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This a web problem, using node.js as the programming language. It only gives a portal showing a login form.</p>

<p>When I started on this problem, there already have been some discoveries made by my team mates(Thanks to Jay and hqdvista). They found this url: <a href="http://94.45.252.237:1024/robots.txt">http://94.45.252.237:1024/robots.txt</a> , as indicated, we got <a href="http://94.45.252.237:1024/pages.js.">http://94.45.252.237:1024/pages.js.</a></p>

<p>After beautifying using <a href="http://jsbeautifier.org,">http://jsbeautifier.org,</a> I reviewed the code, and it shows that there exists another page called auth.js, but <a href="http://94.45.252.237:1024/pages.js">http://94.45.252.237:1024/pages.js</a> is incorrect. Dive into the page.js code again, it&#8217;s filtered out by RE &#8220;/^\/auth&#46;js/&#8221;, so we tried <a href="http://94.45.252.237:1024//auth.js">http://94.45.252.237:1024//auth.js</a> . Wow, it works!</p>

<p>After some comprehension work, we figured out that, the check in auth.js will try to authenticate admin using 2 methods, the first is to check username/password, the second is to check useragent/ip. But we have none of them to even give a try.</p>

<p>Later, according to auth.js, we found this url: <a href="http://94.45.252.237:1024/stats.txt">http://94.45.252.237:1024/stats.txt</a> , which contains a list of login records, but without password. Review the code of auth.js, we can find that if we use the admin useragent and ip, we can get admin access. I wrote a script to try all the ua/ip pair in the stats.txt, resulting the first one is the admin, so that we can access admin page using the command below:</p>

<p>curl -D head.txt -s -A &#8216;Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.1)&#8217; -H &#8216;X-Forwarded-For: 8.8.8.8&#8242; <a href="http://94.45.252.237:1024/admin">http://94.45.252.237:1024/admin</a></p>

<p>However, we just got the same stats list file as previous one, but the content is a bit different. So I reviewed the code of its generation, in <a href="http://94.45.252.237:1024/pages.js,">http://94.45.252.237:1024/pages.js,</a> we found that, when rendering admin page, the first local variable passed in is flag, so the flag is in admin page! But we still need to find out which one is.</p>

<p>After searching the internet, we know that express.js use jade html template, so the admin page should be admin.jade. Then we tried <a href="http://94.45.252.237:1024/admin.jade">http://94.45.252.237:1024/admin.jade</a> , hooray! It reveals that the flag is the string after “Admin &#8211; ”.</p>

<p>Happy cracking!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">zTrix</span></span>

      








  


<time datetime="2012-12-30T00:00:00+08:00" pubdate data-updated="true">Dec 30<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/ctf/'>CTF</a>, <a class='category' href='/blog/categories/writeup/'>writeup</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.blue-lotus.net//ccc-ctf_node/" data-via="" data-counturl="http://www.blue-lotus.net//ccc-ctf_node/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/29c3ctf-web300-pwsafe-writeup/" title="Previous Post: 29c3ctf web300 pwsafe writeup">&laquo; 29c3ctf web300 pwsafe writeup</a>
      
      
        <a class="basic-alignment right" href="/29c3-ctf-minesweeper/" title="Next Post: 29C3 CTF Exploitation 100 minesweeper">29C3 CTF Exploitation 100 minesweeper &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/asis-ctf-finals-2013-login/">ASIS CTF Finals 2013 Login</a>
      </li>
    
      <li class="post">
        <a href="/asis-ctf-memdump-writeup/">ASIS CTF Memdump Writeup</a>
      </li>
    
      <li class="post">
        <a href="/ufo-ctf-2013-reverse-keygenme-writeup/">UFO CTF 2013 Reverse &#8211; KeyGenMe Writeup</a>
      </li>
    
      <li class="post">
        <a href="/ufoctf2013-web100-flagstore/">UFOCTF2013 Web100 FlagStore</a>
      </li>
    
      <li class="post">
        <a href="/sigint-2013-crypto300-satisfaction/">SIGINT 2013 Crypto300 Satisfaction</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - blue-lotus -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'bluelotus';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
